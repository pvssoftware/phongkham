{% load staticfiles %}
<!doctype html>
<html lang="en">
  <head>
    <title>Healthy Care</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Font Awesome 4.7 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Yellowtail Font-->
    <link href="https://fonts.googleapis.com/css?family=Yellowtail&display=swap" rel="stylesheet">
    <!-- Jquery -->
    <script src="{% static 'js/jquery.min.js' %}"></script>

    <!-- UI Jquery css -->
    <link href="{% static 'css/jquery-ui.min.css' %}" rel="stylesheet">
    <!-- DatetimePicker Jquery css -->
    <link href="{% static 'css/jquery.datetimepicker.css' %}" rel="stylesheet">
    
    <link rel="stylesheet" href="{% static 'css/custom_radio.css' %}">
    <link rel="stylesheet" href="{% static 'css/easy-modal-plugin.css' %}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    
    <link rel="stylesheet" href="{% static 'css/my_style.css' %}">
  </head>
  <body>
        <nav class="navbar navbar-expand-lg navbar-dark navbar-mix-bg">
                <a class="navbar-brand navbar-mix-color" href="{% url 'doctor_profile' request.user.pk %}" style="font-family:'Yellowtail', cursive; font-size: 30px;">Healthy Care</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
              
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav mr-auto ">
                    <li class="nav-item">
                      <a class="nav-link navbar-mix-color" href="{% url 'medical_record_create' request.user.pk %}">THÊM BỆNH NHÂN</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link navbar-mix-color" href="{% url 'list_examination' request.user.pk %}">DANH SÁCH CHỜ KHÁM</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link navbar-mix-color" href="{% url 'medicine_list' request.user.pk %}">QUẢN LÝ THUỐC</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link navbar-mix-color" href="{% url 'cal_benefit' request.user.pk %}">DOANH THU</a>
                    </li>

                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle navbar-mix-color" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        CÀI ĐẶT
                      </a>
                      <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="{% url 'settings_openingtime' request.user.pk %}">GIỜ LÀM VIỆC</a>
                        <a class="dropdown-item" href="{% url 'settings_service' request.user.pk %}">DỊCH VỤ KHÁM</a>
                        <a class="dropdown-item" href="{% url 'license' %}">LICENSE</a>
                        <a class="dropdown-item" href="#" id="check-license">Check LICENSE</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="{% url 'logout' %}">THOÁT</a>
                      </div>
                    </li>
                    
      
                  </ul>
                  <form class="form-inline my-2 my-lg-0" id="form_search_navbar" action="{% url 'search_navbar' request.user.pk %}" method="get">
                    <input class="form-control mr-sm-2" type="search" placeholder="Search" name="search_navbar" aria-label="Search" id="search_navbar" autocomplete="off">
                    <button class="btn btn-outline-success btn-navbar-search my-2 my-sm-0" type="button" id="bt_search_navbar" required>Search</button>
                  </form>
                </div>
              </nav>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}" ></script>
    <!-- Jquery UI js file -->
    <script src="{% static 'js/jquery-ui.min.js' %}"></script>
    <!-- DatetimePicker js file -->
    <script src="{% static 'js/jquery.datetimepicker.full.min.js' %}"></script>


    <!-- Modal -->
    <div class="modal fade" id="license-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">About License</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p id="premium-license"></p>
            <p id="remain-days"></p>
            <p id="ultrasound-license"></p>
          </div>
          
        </div>
      </div>
    </div>

              {% block content %}
              Helathy Care
              {% endblock %}
    
    <script>
      $(document).ready(function(){
        // date picker
        $("#search_navbar").datepicker({
        constrainInput: false,
        dateFormat: "dd/mm/yy",
        changeMonth: true,
        changeYear: true,
        // yearRange:"-90:+0",
        monthNames: ["1","2","3","4","5","6","7","8","9","10","11","12"],
        monthNamesShort: ["1","2","3","4","5","6","7","8","9","10","11","12"]
        });// end datepicker

        $("#bt_search_navbar").click(function(){
          var search_navbar = $("#search_navbar").val();
          var valid = true;

          if(search_navbar ===""){
              
                valid &= false;
            }

            if(valid){
              $("#form_search_navbar").submit();
            }
          
        }); //end click

        $("#check-license").click(function(){
          $.ajax({
            type: 'get',
            url: "{% url 'check_license' request.user.pk %}",
            dataType: 'json',
            
            cache: false,
            success: function (data) {
                
                if (data.license === "invalid") {
                  console.error('Failed to check license !');
                    
                } else {
                  $("#license-modal").modal("show");
                  if (data.license === "no"){
                    $("#premium-license").text(`License: không có license`);
                  } else if(data.license === "premium"){
                    $("#premium-license").text(`License: ${data.license}`);
                    $("#remain-days").text(`Còn ${data.remain_days} ngày sử dụng`);
                  }
                  
                  if (data.license_ultrasound){
                    $("#ultrasound-license").text(`Có bản quyền sử dụng app ultrasound`);
                  }
                }
            },
            error: function () {
                console.error('Failed to check license !');
            }
        });
        }); // click check-license
      });
    </script>
  </body>
</html>